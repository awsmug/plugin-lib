/*!
 * plugin-lib (https://github.com/felixarntz/plugin-lib)
 * By Felix Arntz (https://leaves-and-love.net)
 * Licensed under GPL-3.0
 */
!function(e,t){"use strict";function n(){if(!s){s=!0;var e={};e.nonce=t.generate_slug_nonce,e[t.primary_property]=t.primary_property_value;for(var n in u)e[u[n].propertyName]=u[n].$elem.val();wp.ajax.post(t.ajax_prefix+"model_generate_slug",e).done(function(e){e.verified&&e.verified.length&&(l=e.verified,c.val(l),r.text(l),"none"===o.css("display")&&o.fadeIn("slow")),s=!1}).fail(function(e){console.error(e),s=!1})}}function i(){if(!s){s=!0;var i=e("#edit-slug-buttons"),o=i.html(),f=r.html();i.html('<button type="button" class="save button button-small">'+t.i18n.ok+'</button> <button type="button" class="cancel button-link">'+t.i18n.cancel+"</button>"),i.children(".save").one("click",function(){var f=r.children("input").val();if(f==l)return void i.children(".cancel").trigger("click");var d={};d.nonce=t.verify_slug_nonce,d[t.primary_property]=t.primary_property_value,d[t.slug_property]=f,wp.ajax.post(t.ajax_prefix+"model_verify_slug",d).done(function(t){if(t.verified&&t.verified.length){if(l=t.verified,i.html(o),c.val(l),r.text(l),e(".edit-slug").focus(),!a){a=!0;for(var f in u)u[f].$elem.off("change",n)}s=!1}else i.children(".cancel").trigger("click")}).fail(function(e){console.error(e),i.children(".cancel").trigger("click")})}),i.children(".cancel").one("click",function(){i.html(o),c.val(l),r.html(f),s=!1}),r.html('<input type="text" id="new-post-slug" value="'+l+'" autocomplete="off" />').children("input").keydown(function(e){var t=e.which;13===t?(e.preventDefault(),i.children(".save").trigger("click")):27===t&&i.children(".cancel").trigger("click")}).keyup(function(){c.val(this.value)}).focus()}}e(".nav-tab").on("click",function(t){var n=e(this),i=n.parent().children(".nav-tab");t.preventDefault(),"true"!==n.attr("aria-selected")&&(i.each(function(){e(this).attr("aria-selected","false"),e(e(this).attr("href")).attr("aria-hidden","true")}),n.attr("aria-selected","true"),e(n.attr("href")).attr("aria-hidden","false"))});var r,l,a,c=e("#post_name"),o=e("#edit-slug-box"),u=[],s=!1;if(c.length&&o.length){if(r=e("#editable-post-name-full"),l=c.val(),a=!!l.length,!a&&t.slug_dependencies)for(var f in t.slug_dependencies){var d=e('[name="'+t.slug_dependencies[f]+'"]:input');d.length&&(u.push({propertyName:t.slug_dependencies[f],$elem:d}),d.on("change",n))}e("#titlediv").on("click",".edit-slug",function(){i()})}}(jQuery,pluginLibEditModelData);